(()=>{"use strict";var e={291:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(601),i=r.n(s),n=r(314),o=r.n(n)()(i());o.push([e.id,'#screen-selector-wrapper{position:relative;margin:0 auto;padding:0 2rem 2rem;width:min-content;max-width:calc(100vw - 10rem)}#screen-selector-wrapper:hover>#screen-selector{transform:translateY(0)}#screen-selector{display:flex;transform:translateY(calc(0.75rem - 100%));transition:transform .2s;border-radius:0 0 1rem 1rem;box-shadow:0 0 7px 0 #000;background:#248;padding:0 .75rem 1rem}#screen-selector #screen-options{display:flex;position:relative;top:.25rem;flex-grow:1;border-radius:.75rem;box-shadow:0 0 5px 0 #000 inset;background:#359;min-height:3rem;overflow:auto hidden}#screen-selector #screen-options::-webkit-scrollbar{border-radius:0 0 .75rem .75rem;box-shadow:0 0 10px #222 inset;background:#248;height:1rem}#screen-selector #screen-options::-webkit-scrollbar-thumb{border-radius:1rem;box-shadow:0 0 5px #222 inset;background:#359}#screen-selector #screen-options::-webkit-scrollbar-thumb:hover{background:#305296;cursor:pointer}#screen-selector #screen-options.firefox-scrollbar{scrollbar-color:#359 #1d3a74}#screen-selector #screen-options .option{display:flex;align-items:center;justify-content:center;transition:box-shadow .2s,scale .2s;margin:.25rem;border-radius:.5rem;box-shadow:0 0 1rem 0 #000;background:#359;cursor:pointer;padding:.25rem;width:2.5rem;min-width:2.5rem;aspect-ratio:1}#screen-selector #screen-options .option:hover{background:#2e4d8a;scale:1.025}#screen-selector #screen-options .option.selected{box-shadow:0 0 5px 0 #000;background:#29447a;scale:.98}#screen-selector #screen-options .option .option-svg{width:100%;height:100%;filter:invert(10%);image-rendering:pixelated}#currency-screen-wrapper{position:absolute;top:-0.5rem;left:1rem;transform:translateY(calc(1.25rem - 100%));transition:transform .2s;border-radius:1rem;background:#472;cursor:pointer;width:11rem;height:min-content}#currency-screen-wrapper::after{position:absolute;top:0;border-radius:1rem;box-shadow:0 0 7px 0 #000;width:100%;height:100%;content:"";pointer-events:none}#currency-screen-wrapper.enabled{transform:translateY(0)}#currency-screen{display:flex;position:relative;flex-direction:column;margin:.75rem;border-radius:.75rem;box-shadow:0 0 5px 0 #000 inset;background:#362}#currency-screen .currency{display:flex;gap:.25rem;align-items:center;justify-content:center;margin:.25rem .5rem;width:calc(100% - 1rem);height:3rem}#currency-screen .currency .currency-icon{margin:.1rem;border-radius:.5rem;box-shadow:0 0 7px 0 #000 inset;background:#333;padding:.25rem;width:auto;height:calc(100% - 1rem);aspect-ratio:1;image-rendering:pixelated}#currency-screen .currency .currency-amount{display:flex;align-items:center;justify-content:center;border-radius:.5rem;box-shadow:0 0 7px 0 #000 inset;background:#333;padding:.25rem;width:75%;color:var(--currency-color);font-family:monospace;font-size:1rem;font-weight:bold}#currency-screen .divider{margin:0 .25rem;border-radius:.5rem;background:#2c3763;width:calc(100% - .5rem);height:.1rem}#currency-handle{position:absolute;right:5.5rem;bottom:calc(1px - .75rem);transform:rotate(90deg);width:2rem;height:7rem;translate:50% 50%;filter:drop-shadow(3px -2px 2px rgba(17, 17, 17, 0.6666666667))}#handle-wine{position:absolute;right:5.5rem;bottom:-1rem;transform:rotate(180deg);width:8rem;translate:50% 50%;filter:drop-shadow(3px -2px 2px rgba(17, 17, 17, 0.6666666667))}@keyframes shake{0%{transform:rotate(0deg)}20%{transform:rotate(5deg)}40%{transform:rotate(-5deg)}60%{transform:rotate(3deg)}80%{transform:rotate(-3deg)}100%{transform:rotate(0deg)}}#inventory{display:flex;position:relative;transition:translate .5s ease-in-out;z-index:1;margin:auto 0 auto -0.5rem;border-radius:0 1rem 1rem 0;background:#742;padding:1rem;width:min-content;height:36rem;translate:calc(1.5rem - 100%)}#inventory::before{position:absolute;top:0;left:0;border-radius:1rem;box-shadow:0 0 10px #222;width:100%;height:100%;content:"";pointer-events:none}#inventory:has(#inform-outer.open) #drawer-handle{left:calc(100% + 20rem)}#inventory.open{translate:0}#inventory #inform-wrapper{position:absolute;top:0;right:-23rem;z-index:-1;width:23rem;height:38rem;overflow:hidden;pointer-events:none}#inventory #inform-wrapper #inform-outer{position:relative;transition:margin-left .5s ease-in-out;margin:1rem 1rem 1rem calc(3rem - 100%);border-radius:0 .5rem .5rem 0;box-shadow:2px -2px 5px rgba(17,17,17,.3333333333);background:#742;width:20rem;height:36rem}#inventory #inform-wrapper #inform-outer.open{margin-left:0}#inventory #inform-wrapper #inform-outer #inform-drawer{display:flex;position:relative;top:.5rem;flex-direction:column;margin:.5rem;border-radius:.5rem;box-shadow:0 0 10px #222 inset;background:#631;width:19rem;height:35rem;font-family:Arial,Helvetica,sans-serif}#inventory #inform-wrapper #inform-outer #inform-drawer:has(.header .desc:empty) .header .desc{display:none}#inventory #inform-wrapper #inform-outer #inform-drawer .header{display:grid;grid-template:"name amount" "desc desc";gap:.5rem;align-items:center;margin:.5rem auto;padding:.5rem;width:90%}#inventory #inform-wrapper #inform-outer #inform-drawer .header .name{grid-area:name;margin-left:auto;text-shadow:0 0 10px #75f066;white-space:nowrap;color:#6e5;font-size:1.25rem;font-weight:750}#inventory #inform-wrapper #inform-outer #inform-drawer .header .amount{grid-area:amount;margin-bottom:.15rem;text-shadow:0 0 5px rgba(17,17,17,.3333333333);color:#a76;font-family:monospace;font-size:1rem}#inventory #inform-wrapper #inform-outer #inform-drawer .header .desc{grid-area:desc;border-radius:.25rem;box-shadow:0 0 10px rgba(17,17,17,.3333333333) inset;background:#613010;padding:.25rem;max-height:8rem;overflow-y:scroll;color:#aaa;font-size:14px;pointer-events:auto;user-select:auto}#inventory #inform-wrapper #inform-outer #inform-drawer .header .desc::-webkit-scrollbar{border-radius:.25rem;box-shadow:0 0 10px #222 inset;background:#631;width:.75rem}#inventory #inform-wrapper #inform-outer #inform-drawer .header .desc::-webkit-scrollbar-thumb{border-radius:.25rem;box-shadow:0 0 5px rgba(17,17,17,.6) inset;background:#742}#inventory #inform-wrapper #inform-outer #inform-drawer .header .desc::-webkit-scrollbar-thumb:hover{background:#7a4929;cursor:pointer}#inventory #inform-wrapper #inform-outer #inform-drawer .header .desc.firefox-scrollbar{scrollbar-color:#631 #742}#inventory #inform-wrapper #inform-outer #inform-drawer .divider{margin:0 auto;border-radius:1rem;background:rgba(119,68,51,.6666666667);width:calc(100% - 1.25rem);height:2px}#inventory #inform-wrapper #inform-outer #inform-drawer .body{margin:1rem}#inventory #inform-wrapper #inform-outer #inform-drawer .body .buttons{display:flex;flex-direction:row;gap:.5rem;width:100%;height:100%}#inventory #inform-wrapper #inform-outer #inform-drawer .body .buttons>*{border:none;border-radius:.25rem;box-shadow:0 0 10px rgba(17,17,17,.3333333333);background:#7a4826;padding:.5rem}#inventory #inform-wrapper #inform-outer #inform-drawer .body .buttons>*:hover{background:#7e4d2d}#inventory #inform-wrapper #inform-outer #inform-drawer .body .buttons>*:active{background:#855738;scale:.95}#inventory #inform-wrapper #inform-outer #inform-drawer .body .buttons .sell-all{margin-left:auto}#inventory #inform-wrapper #inform-outer #drawer-handle{position:absolute;top:50%;left:0;margin-left:calc(100% - 1px);cursor:pointer;padding:.5rem;width:3rem;pointer-events:auto;translate:-0.5rem -50%;user-select:none;filter:drop-shadow(7px 2px 4px rgba(0, 0, 0, 0.2))}#inventory #inv-container{display:flex;flex-direction:column;border-radius:.75rem;background:#7d4d2d;overflow:hidden auto}#inventory #inv-container::-webkit-scrollbar{border-radius:0 1rem 1rem 0;box-shadow:0 0 10px #222 inset;background:#742;width:1.25rem}#inventory #inv-container::-webkit-scrollbar-thumb{border-radius:1rem;box-shadow:0 0 5px #222 inset;background:#854}#inventory #inv-container::-webkit-scrollbar-thumb:hover{background:#8e5e4d;cursor:pointer}#inventory #inv-container::before{position:absolute;top:1rem;left:1rem;border-radius:.75rem;box-shadow:0 0 15px #111 inset;width:calc(100% - 2rem);height:calc(100% - 2rem);content:"";pointer-events:none}#inventory #inv-container.firefox-scrollbar{scrollbar-color:#854 #653a1d}#inventory #inv-container .stage-crops{display:flex;flex-flow:row wrap;gap:.5rem;align-items:center;justify-content:center;margin:.5rem;border-radius:.5rem;box-shadow:0 0 10px #222 inset;background:var(--stage-color);padding:.75rem 0;width:25rem}#inventory #inv-container .stage-crops .crop{border-radius:.75rem;box-shadow:0 0 10px rgba(34,34,34,.3333333333) inset;background:color-mix(in oklab, var(--stage-color) 95%, #000);cursor:pointer;padding:.25rem;width:3rem;pointer-events:auto}#inventory #inv-container .stage-crops .crop:hover{background:color-mix(in oklab, var(--stage-color) 90%, #000)}#inventory #inv-container .stage-crops .crop:hover .icon{animation:shake .4s linear}#inventory #inv-container .stage-crops .crop:active{background:color-mix(in oklab, var(--stage-color) 85%, #000)}#inventory #inv-container .stage-crops .crop:not(.unlocked) .icon{filter:brightness(0) blur(5px)}#inventory #inv-container .stage-crops .crop:not(.unlocked).seen-before .icon{filter:brightness(0.5) blur(2.5px)}#inventory #inv-container .stage-crops .crop .icon{padding:.25rem}#farming-background{position:absolute;top:0;left:0}@keyframes DragShake{0%{transform:rotate(10deg)}50%{transform:rotate(-10deg)}100%{transform:rotate(10deg)}}#plant-drag{position:absolute;z-index:10}#plant-drag .crop{position:absolute;width:3rem;translate:-50% -50%;pointer-events:none}#farming-screen{display:flex;position:absolute;top:0;left:0;width:100%;height:100%}#plant-drag{position:absolute}.crop{display:flex;aspect-ratio:1}.crop .icon{transform-origin:center center;width:100%;pointer-events:none;aspect-ratio:1;user-select:none;image-rendering:pixelated}#technology-tree{position:absolute;width:100%;height:100%;pointer-events:none}.tech-node{position:absolute;width:1rem;aspect-ratio:1;background:red;translate:-50% -50%;border-radius:100%}#technology-screen{display:flex;position:absolute;top:0;left:0;width:100%;height:100%;background:#555}#settings-window{--window-color: #235;position:relative;width:calc(100% - 8rem);height:calc(100% - 12rem);margin:auto}#settings-window .header .title{padding-bottom:0;margin:0;font-size:2rem}#settings-screen{display:flex;position:absolute;top:0;left:0;width:100%;height:100%;background:#345}#settings-screen *{color:#78c0e0;font-weight:1000;font-family:monospace;text-shadow:0 0 10px #78c0e0}.settings-section{margin:.5rem}.settings-container{position:relative;margin:2rem;display:inline-flex;flex-direction:row;align-items:center;flex-wrap:wrap}.bracket{position:absolute;width:2rem;height:calc(100% + 1rem);border-radius:.5rem;border-top:1rem solid #78c0e0;border-bottom:1rem solid #78c0e0;filter:drop-shadow(0 0 10px #78c0e0)}.bracket.left-bracket{left:1.5rem;transform:translateX(-100%);border-left:1rem solid #78c0e0}.bracket.right-bracket{right:1.5rem;transform:translateX(100%);border-right:1rem solid #78c0e0}.settings-title{display:flex;justify-content:center;flex-direction:column;width:100%;margin:.5rem;font-size:2.5rem}.setting{display:flex;justify-content:center;align-items:center;height:3rem;padding:.5rem;margin:.25rem;background:#459;border-radius:.75rem;box-shadow:0 0 5px #222}.setting .button{height:100%;padding:.75rem .5rem;background:#458;border:none;border-radius:.5rem;box-shadow:0 0 5px rgba(17,17,17,.4666666667);transition:box-shadow .2s,scale .2s;white-space:nowrap;font-size:1rem}.setting .button:hover{background:rgba(70,87,137,.9666666667);scale:1.02;cursor:pointer}.setting .button:active{background:rgba(72,89,139,.9333333333);scale:.98;cursor:pointer}.setting .checkbox-wrapper{display:flex;align-items:center;height:100%;background:#458;border-radius:.5rem;box-shadow:0 0 5px rgba(17,17,17,.4666666667)}.setting .checkbox-wrapper .checkbox-text{display:flex;justify-content:center;align-items:center;margin:.5rem;font-size:1rem}.setting .checkbox-wrapper .checkbox-thumb-wrapper{height:2rem;aspect-ratio:2;margin:.25rem;background:#346;border-radius:.5rem;box-shadow:0 0 5px rgba(17,17,17,.4666666667) inset;cursor:pointer;transition:background .2s}.setting .checkbox-wrapper .checkbox-thumb-wrapper:has(.enabled){background:#58b}.setting .checkbox-wrapper .checkbox-thumb-wrapper .checkbox-thumb{height:calc(100% - .4rem);aspect-ratio:1;margin:.2rem;background:#f88;border-radius:.5rem;box-shadow:0 0 5px #f88;transition:margin-left .2s,background .2s}.setting .checkbox-wrapper .checkbox-thumb-wrapper .checkbox-thumb.enabled{margin-left:2.2rem;background:#8f8;box-shadow:0 0 15px #8f8}html,body{background:red;user-select:none}#header-elements{position:absolute;top:0;left:0;width:100%}#structure{display:flex;position:relative;flex-direction:column;background:#3060dd;width:100%;height:100%}.screen{transition:visibility .5s,opacity .5s;visibility:hidden;opacity:0}.screen:not(.active){pointer-events:none}.screen.active{visibility:visible;opacity:1}.preload{transition:background-color 0s,opacity 0s,color 0s,width 0s,height 0s,padding 0s,margin 0s !important;animation-duration:0s !important}',""]);const a=o},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",s=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),s&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),s&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,s,i,n){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(s)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);s&&o[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function r(e){for(var r=-1,s=0;s<t.length;s++)if(t[s].identifier===e){r=s;break}return r}function s(e,s){for(var n={},o=[],a=0;a<e.length;a++){var h=e[a],l=s.base?h[0]+s.base:h[0],c=n[l]||0,d="".concat(l," ").concat(c);n[l]=c+1;var m=r(d),u={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==m)t[m].references++,t[m].updater(u);else{var g=i(u,s);s.byIndex=a,t.splice(a,0,{identifier:d,updater:g,references:1})}o.push(d)}return o}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var n=s(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<n.length;o++){var a=r(n[o]);t[a].references--}for(var h=s(e,i),l=0;l<n.length;l++){var c=r(n[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}n=h}}},659:e=>{var t={};e.exports=function(e,r){var s=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(r)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var s="";r.supports&&(s+="@supports (".concat(r.supports,") {")),r.media&&(s+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(s+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),s+=r.css,i&&(s+="}"),r.media&&(s+="}"),r.supports&&(s+="}");var n=r.sourceMap;n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},318:e=>{e.exports=JSON.parse('{"b":{"stages":[{"name":"Over-world","color":"#742","crops":[{"name":"Carrot","desc":"A classic orange root vegetable that can be munched straight from the soil. Packed with vitamin A and a hint of crunch!","growthTime":15,"unlocked":true},{"name":"Corn","desc":"Tall and golden, corn stalks are a staple on any farm. Perfect for popcorn nights or corn on the cob.","growthTime":30},{"name":"Tomato","desc":"Juicy and red, tomatoes are perfect for salads, sauces, or just munching straight from the vine!","growthTime":18},{"name":"Potato","desc":"A humble underground treasure that’s as versatile as it gets. Boil, mash, fry—potatoes do it all!","growthTime":22},{"name":"Strawberry","desc":"Sweet and slightly tart, strawberries are a treat for both the farmer and anyone craving a fruity snack.","growthTime":12},{"name":"Lettuce","desc":"Crispy and green, lettuce is great for salads or adding a bit of crunch to your sandwich.","growthTime":10},{"name":"Pumpkin","desc":"A big orange vegetable that’s great for Halloween decorations and pies alike. Beware of spooky carvings!","growthTime":40},{"name":"Wheat","desc":"A staple crop that forms the base for bread and tons of baked goodies. Watch the golden waves grow!","growthTime":25},{"name":"Cabbage","desc":"A round, leafy vegetable that’s perfect for hearty soups, stews, and even a little sauerkraut.","growthTime":28},{"name":"Blueberry","desc":"Small but mighty! These tiny blue gems are packed with flavor and antioxidants.","growthTime":14},{"name":"Radish","desc":"A spicy little root with a kick. Great for salads or just nibbling on fresh from the ground.","growthTime":8},{"name":"Sunflower","desc":"Not just a flower! These bright blooms also produce seeds, perfect for snacking or replanting.","growthTime":35}]}]},"R":[{"x":0,"y":0,"name":"Coal","desc":"Coal is a fossil fuel that’s been burned for thousands of years. It’s a great source of energy, but it’s also a major polluter.","requires":[]},{"x":0,"y":100,"name":"Iron","desc":"Iron is a metal that’s been used for thousands of years. It’s a great source of strength, but it’s also a major polluter.","requires":["Coal"]}]}')}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={id:s,exports:{}};return e[s](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nc=void 0;class s{constructor(e,t){this.renderName=!0,this.renderSymbol=!0,this.name=e,this.symbol=t}log(...e){const t=new Array,r=new Array;for(const s of e)"string"==typeof s?t.push(s):r.push(s);console.log(this.getFixed(...t),...r)}warn(...e){const t=new Array,r=new Array;for(const s of e)"string"==typeof s?t.push(s):r.push(s);console.warn(this.getFixed(...t),...r)}error(...e){const t=new Array,r=new Array;for(const s of e)"string"==typeof s?t.push(s):r.push(s);console.error(this.getFixed(...t),...r)}throw(...e){throw this.getFixed(...e)}toggleName(){this.renderName=!this.renderName}toggleSymbol(){this.renderSymbol=!this.renderSymbol}getFixed(...e){return this.renderSymbol&&this.symbol?this.renderName?`${this.symbol} [${this.name}] ${e} ${this.symbol}`:`${this.symbol} ${e} ${this.symbol}`:this.renderName?`[${this.name}] ${e}`:`${e}`}}var i,n=r(72),o=r.n(n),a=r(825),h=r.n(a),l=r(659),c=r.n(l),d=r(56),m=r.n(d),u=r(540),g=r.n(u),p=r(113),f=r.n(p),w=r(291),b={};b.styleTagTransform=f(),b.setAttributes=m(),b.insert=c().bind(null,"head"),b.domAPI=h(),b.insertStyleElement=g(),o()(w.A,b),w.A&&w.A.locals&&w.A.locals;class y{constructor(){this.lastTime=performance.now(),this.FPS=0}update(){const e=performance.now(),t=e-this.lastTime;return this.lastTime=e,this.FPS=1e3/t,t}}function x(e,t,r=""){if(null==e)throw new Error(t+"\n"+r)}function v(e,t,...r){const s=document.createElement(e);return void 0!==t&&(void 0!==t.parent&&(t.parent.appendChild(s),delete t.parent),void 0!==t.classes&&t.classes.length>0&&(s.classList.add(...t.classes),delete t.classes),Object.assign(s,t)),s.append(...r),s}function k(e,...t){return v("div",e,...t)}function T(e,...t){return v("canvas",e,...t)}function C(e){const t=document.getElementById(e);return x(t,`Element with id "${e}" not found.`),t}function E(e){return document.querySelector(e)}!function(e){e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"}(i||(i={}));class S{constructor(e){this.x=0,this.y=0,this.element=e,x(e,"MouseAttachment can only be attached to HTMLElements."),this.element.addEventListener("mousemove",(e=>{this.x=e.clientX,this.y=e.clientY}))}static attach(e){return S.instances.has(e)?S.instances.get(e):new S(e)}set onDown(e){this.element.addEventListener("mousedown",(t=>e(t.button)))}set onUp(e){this.element.addEventListener("mouseup",(t=>e(t.button)))}set onClick(e){this.element.addEventListener("click",(t=>e(t.button)))}set onMove(e){this.element.addEventListener("mousemove",(t=>e(t.movementX,t.movementY)))}set onDrag(e){this.element.addEventListener("drag",(t=>e(t.movementX,t.movementY)))}set onDragStart(e){this.element.addEventListener("dragstart",(()=>e()))}set onDragStop(e){this.element.addEventListener("dragend",(()=>e()))}set onDragOver(e){this.element.addEventListener("dragover",(()=>e()))}set onEnter(e){this.element.addEventListener("mouseenter",(()=>e()))}set onHover(e){this.element.addEventListener("mouseover",(()=>e()))}set onLeave(e){this.element.addEventListener("mouseleave",(()=>e()))}set onWheel(e){this.element.addEventListener("wheel",(t=>e(t.deltaY)))}set onResize(e){this.element.addEventListener("resize",(()=>e(this.element.clientWidth,this.element.clientHeight)))}set onDownRaw(e){this.element.addEventListener("mousedown",e)}set onUpRaw(e){this.element.addEventListener("mouseup",e)}set onClickRaw(e){this.element.addEventListener("click",e)}set onMoveRaw(e){this.element.addEventListener("mousemove",e)}set onDragRaw(e){this.element.addEventListener("drag",e)}set onDragStartRaw(e){this.element.addEventListener("dragstart",e)}set onDragStopRaw(e){this.element.addEventListener("dragend",e)}set onDragOverRaw(e){this.element.addEventListener("dragover",e)}set onEnterRaw(e){this.element.addEventListener("mouseenter",e)}set onHoverRaw(e){this.element.addEventListener("mouseover",e)}set onLeaveRaw(e){this.element.addEventListener("mouseleave",e)}set onWheelRaw(e){this.element.addEventListener("wheel",e)}}S.instances=new Map;class M{constructor(e){this.root=e}initialize(){}update(e){}updateFrame(){}}class L extends M{initialize(){const e=C("currency-screen-wrapper");S.attach(e).onClickRaw=t=>{t.button===i.LEFT&&(e.classList.toggle("enabled"),t.stopPropagation())}}static registerCurrency(e){this.currencies.set(e.name,e),this.setupCurrencyElement(e)}static getCurrency(e){const t=this.currencies.get(e);return x(t,`Currency with id "${e}" not found!`),t}static setupCurrencyElement(e){const t=C("currency-screen");this.currencies.size>1&&k({classes:["divider"],parent:t});const r=k({id:`${e.name}-research`,classes:["currency"],parent:t},v("img",{classes:["currency-icon"],src:`assets/images/currencies/${e.name}.png`})),s=k({classes:["currency-amount"],parent:r});e.attachElement(s)}}L.currencies=new Map;const z=(e=Y())=>N(A(e)),N=e=>({random:()=>B(e),uint32:()=>$(e),fract53:()=>I(e),nextT:t=>{const r=F(t);return()=>r(e)},getState:()=>Object.assign({},e)}),B=e=>{const t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},$=e=>4294967296*B(e),I=e=>B(e)+11102230246251565e-32*(2097152*B(e)|0),F=e=>t=>e(B(t)),A=e=>P(e,R()),P=(e,t)=>{let r=H,s=W(r=D(" ",r)),i=W(r=D(" ",r)),n=W(r=D(" ",r));return s-=W(r=D(e,r)),s<0&&(s+=1),i-=W(r=D(e,r)),i<0&&(i+=1),n-=W(r=D(e,r)),n<0&&(n+=1),t.s0=s,t.s1=i,t.s2=n,t.c=1,t},R=()=>({s0:0,s1:0,s2:0,c:0}),H=4022871197,D=(e,t)=>{for(let r=0;r<e.length;r++){let s=.02519603282416938*(t+=e.charCodeAt(r));s-=t=s>>>0,s*=t,s-=t=s>>>0,t+=4294967296*s}return t},W=e=>2.3283064365386963e-10*(e>>>0),Y=()=>`${Date.now()}`,U=e=>{const t=O(e);return{noise2D:(e,r)=>q(t,e,r),noise3D:(e,r,s)=>j(t,e,r,s),noise4D:(e,r,s,i)=>X(t,e,r,s,i)}},q=(e,t,r)=>{const{perm:s,permMod12:i}=e;let n=0,o=0,a=0;const h=(t+r)*V,l=Math.floor(t+h),c=Math.floor(r+h),d=(l+c)*G,m=t-(l-d),u=r-(c-d),g=m>u?1:0,p=m>u?0:1,f=m-g+G,w=u-p+G,b=m-1+2*G,y=u-1+2*G,x=255&l,v=255&c;let k=.5-m*m-u*u;if(k>=0){const e=3*i[x+s[v]];k*=k,n=k*k*(Z[e]*m+Z[e+1]*u)}let T=.5-f*f-w*w;if(T>=0){const e=3*i[x+g+s[v+p]];T*=T,o=T*T*(Z[e]*f+Z[e+1]*w)}let C=.5-b*b-y*y;if(C>=0){const e=3*i[x+1+s[v+1]];C*=C,a=C*C*(Z[e]*b+Z[e+1]*y)}return 70*(n+o+a)},j=(e,t,r,s)=>{const{perm:i,permMod12:n}=e;let o=0,a=0,h=0,l=0;const c=(t+r+s)*J,d=Math.floor(t+c),m=Math.floor(r+c),u=Math.floor(s+c),g=(d+m+u)*_,p=t-(d-g),f=r-(m-g),w=s-(u-g);let b,y,x,v,k,T;p>=f?f>=w?(b=1,y=0,x=0,v=1,k=1,T=0):p>=w?(b=1,y=0,x=0,v=1,k=0,T=1):(b=0,y=0,x=1,v=1,k=0,T=1):f<w?(b=0,y=0,x=1,v=0,k=1,T=1):p<w?(b=0,y=1,x=0,v=0,k=1,T=1):(b=0,y=1,x=0,v=1,k=1,T=0);const C=p-b+_,E=f-y+_,S=w-x+_,M=p-v+2*_,L=f-k+2*_,z=w-T+2*_,N=p-1+3*_,B=f-1+3*_,$=w-1+3*_,I=255&d,F=255&m,A=255&u;let P=.6-p*p-f*f-w*w;if(P>=0){const e=3*n[I+i[F+i[A]]];P*=P,o=P*P*(Z[e]*p+Z[e+1]*f+Z[e+2]*w)}let R=.6-C*C-E*E-S*S;if(R>=0){const e=3*n[I+b+i[F+y+i[A+x]]];R*=R,a=R*R*(Z[e]*C+Z[e+1]*E+Z[e+2]*S)}let H=.6-M*M-L*L-z*z;if(H>=0){const e=3*n[I+v+i[F+k+i[A+T]]];H*=H,h=H*H*(Z[e]*M+Z[e+1]*L+Z[e+2]*z)}let D=.6-N*N-B*B-$*$;if(D>=0){const e=3*n[I+1+i[F+1+i[A+1]]];D*=D,l=D*D*(Z[e]*N+Z[e+1]*B+Z[e+2]*$)}return 32*(o+a+h+l)},X=(e,t,r,s,i)=>{const{perm:n}=e;let o=0,a=0,h=0,l=0,c=0;const d=(t+r+s+i)*Q,m=Math.floor(t+d),u=Math.floor(r+d),g=Math.floor(s+d),p=Math.floor(i+d),f=(m+u+g+p)*K,w=t-(m-f),b=r-(u-f),y=s-(g-f),x=i-(p-f);let v,k,T,C,E,S,M,L,z,N,B,$,I=0,F=0,A=0,P=0;w>b?I++:F++,w>y?I++:A++,w>x?I++:P++,b>y?F++:A++,b>x?F++:P++,y>x?A++:P++,v=I>=3?1:0,k=F>=3?1:0,T=A>=3?1:0,C=P>=3?1:0,E=I>=2?1:0,S=F>=2?1:0,M=A>=2?1:0,L=P>=2?1:0,z=I>=1?1:0,N=F>=1?1:0,B=A>=1?1:0,$=P>=1?1:0;const R=w-v+K,H=b-k+K,D=y-T+K,W=x-C+K,Y=w-E+2*K,U=b-S+2*K,q=y-M+2*K,j=x-L+2*K,X=w-z+3*K,O=b-N+3*K,V=y-B+3*K,G=x-$+3*K,J=w-1+4*K,_=b-1+4*K,Z=y-1+4*K,te=x-1+4*K,re=255&m,se=255&u,ie=255&g,ne=255&p;let oe=.6-w*w-b*b-y*y-x*x;if(oe>=0){const e=n[re+n[se+n[ie+n[ne]]]]%32*4;oe*=oe,o=oe*oe*(ee[e]*w+ee[e+1]*b+ee[e+2]*y+ee[e+3]*x)}let ae=.6-R*R-H*H-D*D-W*W;if(ae>=0){const e=n[re+v+n[se+k+n[ie+T+n[ne+C]]]]%32*4;ae*=ae,a=ae*ae*(ee[e]*R+ee[e+1]*H+ee[e+2]*D+ee[e+3]*W)}let he=.6-Y*Y-U*U-q*q-j*j;if(he>=0){const e=n[re+E+n[se+S+n[ie+M+n[ne+L]]]]%32*4;he*=he,h=he*he*(ee[e]*Y+ee[e+1]*U+ee[e+2]*q+ee[e+3]*j)}let le=.6-X*X-O*O-V*V-G*G;if(le>=0){const e=n[re+z+n[se+N+n[ie+B+n[ne+$]]]]%32*4;le*=le,l=le*le*(ee[e]*X+ee[e+1]*O+ee[e+2]*V+ee[e+3]*G)}let ce=.6-J*J-_*_-Z*Z-te*te;if(ce>=0){const e=n[re+1+n[se+1+n[ie+1+n[ne+1]]]]%32*4;ce*=ce,c=ce*ce*(ee[e]*J+ee[e+1]*_+ee[e+2]*Z+ee[e+3]*te)}return 27*(o+a+h+l+c)},O=e=>{const t=new Uint8Array(512),r=new Uint8Array(512),s=new Uint8Array(256);for(let e=0;e<256;e++)s[e]=e;for(let i=0;i<255;i++){const n=i+~~(e()*(256-i)),o=s[n];s[n]=s[i],t[i]=t[i+256]=o,r[i]=r[i+256]=o%12}const i=s[255];return t[255]=t[511]=i,r[255]=r[511]=i%12,{perm:t,permMod12:r}},V=.5*(Math.sqrt(3)-1),G=(3-Math.sqrt(3))/6,J=1/3,_=1/6,Q=(Math.sqrt(5)-1)/4,K=(5-Math.sqrt(5))/20,Z=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),ee=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class te extends M{constructor(e,t){super(e),this.body=document.getElementById(`${t}-screen`),this.selector=document.getElementById(`${t}-screen-option`),S.attach(this.selector).onClickRaw=t=>this.enable(e,t)}enable(e,t){e.disableAllScreens(),this.selector.classList.add("selected"),this.body.classList.add("active"),t&&t.stopPropagation()}disable(){this.selector.classList.remove("selected"),this.body.classList.remove("active")}}class re{constructor(e,t,r,s){this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=r,this.height=s}contains(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}containsRect(e){return this.contains(e.x,e.y)&&this.contains(e.x+e.width,e.y+e.height)}intersects(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}expandBy(e,t){return new re(this.x-e,this.y-t,this.width+2*e,this.height+2*t)}scaleBy(e){return new re(this.x*e,this.y*e,this.width*e,this.height*e)}floor(){return new re(Math.floor(this.x),Math.floor(this.y),Math.floor(this.width),Math.floor(this.height))}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get left(){return this.x}}class se{constructor(){this.listeners=[]}add(e){this.listeners.push(e)}dispatch(...e){for(const t of this.listeners)t(...e)}}class ie{constructor(e,t){this.x=this.cast(e),this.y=this.cast(t)}add(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(this.x+e.x,this.y+e.y)}sub(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(this.x-e.x,this.y-e.y)}mult(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(this.x*e.x,this.y*e.y)}div(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(this.x/e.x,this.y/e.y)}pow(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(Math.pow(this.x,e.x),Math.pow(this.y,e.y))}min(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return"number"==typeof e&&(e=new ie(e,e)),new ie(Math.max(this.x,e.x),Math.max(this.y,e.y))}abs(){return new ie(Math.abs(this.x),Math.abs(this.y))}floor(){return new ie(Math.floor(this.x),Math.floor(this.y))}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}dot(e){return this.x*e.x+this.y*e.y}cast(e){return e}toString(){return`(${this.x}, ${this.y})`}}class ne extends M{constructor(e,t){super(e),this.onCenterChange=new se,this.onUpdate=new se,this.worldX=0,this.worldY=0,this.renderRect=new re(0,0,0,0),this.top=0,this.right=0,this.bottom=0,this.left=0,this.background=C(t),this.attachment=S.attach(this.background),this.context=this.background.getContext("2d")}initialize(){this.background.width=this.root.windowWidth,this.background.height=this.root.windowHeight,this.root.windowMouse.onResize=(e,t)=>{this.background.width=e,this.background.height=t,this.reinitializeSides();const r=this.getCenter();this.onCenterChange.dispatch(r.x,r.y),this.onUpdate.dispatch()},this.reinitializeSides();{let e=!1;this.attachment.onDown=t=>{t===i.LEFT&&(e=!0)},this.root.windowMouse.onUp=t=>{t===i.LEFT&&(e=!1)},this.root.windowMouse.onLeave=()=>e=!1,this.root.windowMouse.onMove=(t,r)=>{if(!e)return;this.worldX+=t,this.worldY+=r,this.reinitializeSides();const s=this.getCenter();this.onCenterChange.dispatch(s.x,s.y),this.onUpdate.dispatch()}}}screenToWorld(e,t){const r=this.getCenter();return new ie(e-r.x,t-r.y)}reinitializeSides(){const e=this.root.windowWidth,t=this.root.windowHeight,r=this.worldX,s=this.worldY;this.right=e/2-r,this.bottom=t/2-s,this.left=-e/2-r,this.top=-t/2-s,this.renderRect.x=this.left,this.renderRect.y=this.top,this.renderRect.width=this.right-this.left,this.renderRect.height=this.bottom-this.top}startDrawing(){this.context.clearRect(0,0,this.root.windowWidth,this.root.windowHeight);const e=this.getCenter();this.context.save(),this.context.translate(e.x,e.y)}finalizeDrawing(){this.context.restore()}getCenter(){return new ie(this.worldX+this.root.windowWidth/2,this.worldY+this.root.windowHeight/2)}}class oe extends M{getByQuery(e){const t=this.body.querySelector(e);if(null===t)throw new Error(`No children with query ${e} found`);return t}getFirstChildClass(e){const t=this.body.querySelector(`.${e}`);if(null===t)throw new Error(`No children with class ${e} found`);return t}getChildID(e){const t=this.body.querySelector(`#${e}`);if(null===t)throw new Error(`No children with id ${e} found`);return t}}class ae extends oe{constructor(e,t,r){super(e),this.currentCrop=null,this.cropBody=null,this.growthState=0,this.progress=0,this.growthWobble=null,this.x=t,this.y=r}update(e){if(this.currentCrop&&this.progress<100){if(this.progress+=100/this.currentCrop.growTime*e,this.progress<100)return;this.currentCrop.replantAble?this.replantCrop():(this.cropBody.classList.add("done"),setTimeout(this.cleanCrop.bind(this),500))}}updateFrame(){if(!this.cropBody)return;const e=Math.floor(this.progress/25);this.growthState!==e&&(this.growthState=e,this.cropBody.classList.add("wobble"),this.growthWobble&&clearTimeout(this.growthWobble),this.growthWobble=setTimeout((()=>this.cropBody.classList.remove("wobble")),500),this.cropBody.style.setProperty("--progress",""+(this.growthState/5+.2)))}harvestCrop(){this.currentCrop&&this.cropBody&&(this.progress<100||this.currentCrop.amount++)}cleanCrop(){this.currentCrop&&this.cropBody&&(this.harvestCrop(),this.cropBody.remove(),this.growthWobble&&clearTimeout(this.growthWobble),this.currentCrop=null,this.cropBody=null)}plantCrop(e){this.currentCrop=e,this.cropBody=e.createHTML(),this.cropBody.style.setProperty("--progress","0.20"),this.body.appendChild(this.cropBody),this.progress=0}replantCrop(){this.currentCrop&&this.cropBody&&(this.harvestCrop(),this.cropBody.style.setProperty("--progress","0.2"),this.progress=0)}isEmpty(){return!this.currentCrop}createElement(e){const t=k({classes:["land-wrapper"],parent:e});this.body=k({classes:["land"],parent:t}),this.updateFrame()}}class he{constructor(){this.sides=[],this.imagesByName=new Map,this.texturesByHash=[],this.loaded=!1,this.loadedEvent=new se}loadImages(){return Promise.all(this.sides.map((e=>new Promise(((t,r)=>{const s=new Image,i=`assets/images/tiles/${e}.png`;s.src=i,s.onload=()=>t({name:e,image:s}),s.onerror=()=>r(new Error(`Failed to load image: ${i}`))})))))}hashToNeighbors(e){const t=Array(8).fill(!1);for(let r=0;r<8;r++)t[r]=!!(e&1<<r);return t}neighborsToHash(e){return e.reduce(((e,t,r)=>e+(t?1<<r:0)),0)}}class le extends he{constructor(){super(),this.sides=["farm-corner","farm-side","farm-middle","farm-inner-corner","wetness"],this.loadImages().then((e=>{for(const{name:t,image:r}of e)this.imagesByName.set(t,r);this.createTexturesByRules()}))}getTextureByRules(e){const t=this.neighborsToHash(e),r=this.texturesByHash[t];if(!r)throw new Error(`No texture for neighbors: ${e.join(", ")}`);return r}createTexturesByRules(){for(let e=0;e<Math.pow(2,8);e++){const t=this.hashToNeighbors(e),r=T();r.width=32,r.height=32;const s=r.getContext("2d"),i=this.imagesByName.get("farm-corner"),n=this.imagesByName.get("farm-inner-corner"),o=this.imagesByName.get("farm-side"),a=this.imagesByName.get("farm-middle"),h=[[3,0,1],[1,2,4],[6,5,3],[4,7,6]],l=[0,Math.PI/2,-Math.PI/2,Math.PI];for(let e=0;e<2;e++)for(let r=0;r<2;r++){const c=e+2*r,d=h[c],m=l[c],u=t[d[0]],g=t[d[1]],p=t[d[2]];s.save(),s.translate(16*e+8,16*r+8),s.rotate(m),u&&p&&!g?s.drawImage(n,-8,-8):u&&p&&g?s.drawImage(a,-8,-8):u&&!p?(s.rotate(Math.PI/2),s.drawImage(o,-8,-8)):!u&&p?s.drawImage(o,-8,-8):s.drawImage(i,-8,-8),s.restore()}const c=this.imagesByName.get("wetness");s.drawImage(c,0,0),this.texturesByHash[e]=r}this.loaded=!0,this.loadedEvent.dispatch()}}class ce{constructor(){this.flowers=new Array(32).fill(0).map(((e,t)=>"grassandflowers"+(t+1))),this.flowerCanvases=[],this.loaded=!1,this.loadedEvent=new se,this.loadImages().then((e=>{for(const{image:t}of e)this.flowerCanvases.push(this.setupFlower(t));this.loaded=!0,this.loadedEvent.dispatch()}))}getFlower(e){const t=Math.floor(e()*this.flowers.length);return this.flowerCanvases[t]}setupFlower(e){const t=T();return t.width=16,t.height=16,t.getContext("2d").drawImage(e,0,0),t}loadImages(){return Promise.all(this.flowers.map((e=>new Promise(((t,r)=>{const s=new Image,i=`assets/images/flowers/${e}.png`;s.src=i,s.onload=()=>t({name:e,image:s}),s.onerror=()=>r(new Error(`Failed to load image: ${i}`))})))))}}class de extends he{constructor(){super(),this.sides=["grass-corner","grass-side","grass-outer-corner"],this.differentFullTiles=[],this.loadImages().then((e=>{for(const{name:t,image:r}of e)this.imagesByName.set(t,r);this.createTexturesByRules()}))}getTextureByRules(e){const t=this.neighborsToHash(e),r=this.texturesByHash[t];if(!r)throw new Error(`No texture for neighbors: ${e.join(", ")}`);return r}createTexturesByRules(){for(let e=0;e<Math.pow(2,8);e++){const t=this.hashToNeighbors(e),r=T();r.width=32,r.height=32;const s=r.getContext("2d"),i=this.imagesByName.get("grass-corner"),n=this.imagesByName.get("grass-outer-corner"),o=this.imagesByName.get("grass-side"),a=[[3,0,1],[1,2,4],[6,5,3],[4,7,6]],h=[0,Math.PI/2,-Math.PI/2,Math.PI];for(let e=0;e<2;e++)for(let r=0;r<2;r++){const l=e+2*r,c=a[l],d=h[l],m=t[c[0]],u=t[c[1]],g=t[c[2]];s.save(),s.translate(16*e+8,16*r+8),s.rotate(d),m&&u&&g?s.drawImage(i,-8,-8):!m&&g?(s.rotate(Math.PI/2),s.drawImage(o,-8,-8)):m&&!g?s.drawImage(o,-8,-8):m||g||!u?m&&g&&!u&&s.drawImage(i,-8,-8):s.drawImage(n,-8,-8),s.restore()}this.texturesByHash[e]=r}this.loaded=!0,this.loadedEvent.dispatch()}}class me extends oe{constructor(e,t,r,s){super(e),this.amount=0,this.growTime=1,this.replantAble=!0,this.unlocked=!1,this.seenBefore=!1,this.name=t,this.desc=r,this.growTime=s}setUnlocked(e){this.unlocked=e,this.body.classList.toggle("unlocked",this.unlocked),this.unlocked&&this.setSeenBefore(!0)}getUnlocked(){return this.unlocked}setSeenBefore(e){this.seenBefore=e,this.body.classList.toggle("seen-before",this.seenBefore)}getImage(){return`assets/images/crops/${this.name}.png`}createHTML(){const e=k({classes:["crop"]});return""!==this.name&&(e.innerHTML=`<img class="icon" src="${this.getImage()}" alt="${this.name}">`),e}createElement(e){this.body=this.createHTML(),e.appendChild(this.body)}}const ue=r(318).b;class ge extends M{constructor(e){super(e),this.inventory=[],this.renderingCrop=null,this.draggingCrop=null,this.dragging=null,this.draggingTimeout=null,this.expanded=!1,this.informExpanded=!1,this.toggleable=!0,this.prevX=-1,this.prevY=-1,this.angle=0,this.angleVel=0,this.body=C("inventory"),this.innerBody=C("inv-container"),this.informOuter=C("inform-outer")}initialize(){{const e=ue.stages;for(const t of e){const e=t.color,r=t.name,s=this.registerStage(r,e);for(const e of t.crops)this.registerCrop(s,e)}}this.root.windowMouse.onUp=e=>{var t;e===i.LEFT&&(null===(t=this.dragging)||void 0===t||t.remove(),this.dragging=null,this.draggingCrop=null)},S.attach(this.body).onLeave=()=>{(this.draggingCrop||this.draggingTimeout)&&(this.toggleable||setTimeout((()=>this.completelyClose()),500),this.completelyClose())},C("drawer-handle").addEventListener("click",(()=>this.toggleSelection()))}update(e){if(!this.dragging)return;const t=this.root.windowMouse.x,r=this.root.windowMouse.y;this.prevX<0&&(this.prevX=t),this.prevY<0&&(this.prevY=r);const s=(t-this.prevX)/e*.1,i=(r-this.prevY)/e*.1,n=s*Math.cos(this.angle-Math.PI/4)-(50-i)*Math.sin(this.angle-Math.PI/4);this.angleVel+=n*e,this.angle+=this.angleVel*e,this.angleVel*=.995,this.prevX=t,this.prevY=r,this.dragging.style.left=t+"px",this.dragging.style.top=r+"px",this.dragging.firstChild.style.transform=`rotate(${this.angle-Math.PI/4}rad) translateY(35%) rotate(45deg)`}updateFrame(){this.renderingCrop&&(C("information-crop-amount").innerText=`[${this.renderingCrop.amount}]`)}registerStage(e,t){const r=k({id:`stage-${e}`,classes:["stage-crops"],parent:this.innerBody});return r.style.setProperty("--stage-color",t),{name:e,color:t,crops:[],body:r}}registerCrop(e,t){const r=new me(this.root,t.name,t.desc,t.growthTime);e.crops.push(r),r.createElement(e.body),t.unlocked&&r.setUnlocked(!0);const s=S.attach(r.body);s.onClick=e=>{e===i.LEFT&&r.getUnlocked()&&this.toggleCropRender(r)},s.onDown=e=>{e===i.LEFT&&r.getUnlocked()&&(this.draggingTimeout=setTimeout((()=>{this.startDraggingCrop(r),this.draggingTimeout=null}),200))},s.onUp=e=>{e===i.LEFT&&this.draggingTimeout&&(clearTimeout(this.draggingTimeout),this.draggingTimeout=null)}}toggleSelection(){this.toggleable&&(this.toggleable=!1,setTimeout((()=>this.toggleable=!0),500),this.informExpanded?(this.informExpanded=!1,this.renderingCrop=null,this.getAudio("closing").play()):this.expanded?(this.expanded=!1,this.getAudio("closing").play()):(this.expanded=!0,this.getAudio("opening").play()),this.body.classList.toggle("open",this.expanded),this.informOuter.classList.toggle("open",this.informExpanded))}completelyClose(){this.toggleable?(this.informExpanded||this.expanded)&&(this.expanded=!1,this.informExpanded=!1,this.body.classList.toggle("open",!1),this.informOuter.classList.toggle("open",!1),this.getAudio("closing").play()):setTimeout((()=>this.completelyClose()),500)}toggleCropRender(e){if(!this.toggleable)return void setTimeout(this.toggleCropRender.bind(this),100);null!==this.renderingCrop&&this.renderingCrop!==e||(this.toggleable=!1,setTimeout((()=>this.toggleable=!0),500)),this.renderingCrop===e?this.renderingCrop=null:this.renderingCrop=e;const t=e.name.split("_").map((e=>e[0].toUpperCase()+e.slice(1))).join(" "),r=C("inform-drawer");this.informExpanded!==!!this.renderingCrop&&(this.informExpanded=!!this.renderingCrop,this.informOuter.classList.toggle("open",this.informExpanded),this.getAudio(this.informExpanded?"opening":"closing").play()),this.informOuter.classList.toggle("open",this.informExpanded),this.renderingCrop&&(r.innerHTML=`\n            <div class="header">\n                <span class="name">${t}</span><span id="information-crop-amount" class="amount">[${e.amount}]</span>\n                <span class="desc">${e.desc}</span>\n            </div>\n            <div class="divider"></div>\n            <div class="body">\n                <div class="buttons">\n                    <button class="sell">Sell 1</button>\n                    <button class="sell">Sell 10</button>\n                    <button class="sell-all">Sell All</button>\n                </div>\n            </div>\n        `)}startDraggingCrop(e){this.dragging||(this.draggingCrop=e,this.dragging=e.createHTML(),this.prevX=-1,this.prevY=-1,this.angle=0,this.angleVel=0,C("plant-drag").appendChild(this.dragging))}getAudio(e){return C(`drawer-${e}`)}}class pe extends te{constructor(e){super(e,"farming"),this.tileSize=63,this.farmTileSet=new le,this.grassTileSet=new de,this.flowerSet=new ce,this.farmTiles=new Map,this.inventory=new ge(this.root),this.background=new ne(e,"farming-background"),this.farmTileSet.loadedEvent.add((()=>this.drawBackground())),this.grassTileSet.loadedEvent.add((()=>this.drawBackground())),this.flowerSet.loadedEvent.add((()=>this.drawBackground()))}initialize(){this.background.initialize(),this.background.attachment.onClick=e=>{e===i.LEFT&&this.inventory.completelyClose()},this.background.onUpdate.add((()=>{this.drawBackground()})),this.inventory.initialize(),this.background.attachment.onClickRaw=e=>{if(e.button!==i.LEFT)return;const t=this.background.screenToWorld(e.offsetX,e.offsetY).div(this.tileSize).floor(),r=t.toString();if(this.farmTiles.has(r))return;const s=new ae(this.root,t.x,t.y);this.farmTiles.set(r,s),this.drawBackground(),e.preventDefault()}}update(e){this.inventory.update(e)}updateFrame(){this.inventory.updateFrame()}drawBackground(){if(!this.farmTileSet.loaded)return;if(!this.grassTileSet.loaded)return;if(!this.flowerSet.loaded)return;this.background.startDrawing();const e=this.background.context;e.imageSmoothingEnabled=!1;const t=this.background.renderRect,r=Math.ceil(this.tileSize/32),{random:s}=z(this.root.seed),{noise2D:i}=U(s),n=t.scaleBy(1/this.tileSize).floor();for(let t=n.left;t<=n.right+1;t++)for(let s=n.top;s<=n.bottom+1;s++){e.translate(t*this.tileSize,s*this.tileSize),e.scale(r,r);for(let r=0;r<2;r++)for(let n=0;n<2;n++){const o=25,a=15*i((2*t+r)/o,(2*s+n)/o);e.fillStyle=`rgb(${62+a} ${137+a} ${72+a})`,e.fillRect(16*r+1,16*n+1,17,17)}const n=this.farmTiles.has(`(${t}, ${s})`)?this.farmTileSet:this.grassTileSet,o=this.getNeighbors(t,s),a=n.getTextureByRules(o);e.drawImage(a,0,0),e.scale(1/r,1/r),e.translate(-t*this.tileSize,-s*this.tileSize)}for(let t=n.left;t<=n.right+1;t++)for(let s=n.top;s<=n.bottom+1;s++){e.translate(t*this.tileSize,s*this.tileSize),e.scale(r,r);const i=this.farmTiles.has(`(${t}, ${s})`),n=this.getNeighbors(t,s);if(!i&&n.every((e=>!e)))for(let r=0;r<2;r++)for(let i=0;i<2;i++){const n=2*t+r,o=2*s+i,{random:a}=z(`${this.root.seed} (${n}, ${o})`);if(a()>.2)continue;const h=this.flowerSet.getFlower(a),l=16*a()-8,c=16*a()-8,d=.4*(a()-.5);h&&(e.translate(16*r+8,16*i+8),e.rotate(d),e.drawImage(h,l-8,c-8),e.rotate(-d),e.translate(16*-r-8,16*-i-8))}e.scale(1/r,1/r),e.translate(-t*this.tileSize,-s*this.tileSize)}this.background.finalizeDrawing()}getNeighbors(e,t){return[!!this.farmTiles.get(`(${e-1}, ${t-1})`),!!this.farmTiles.get(`(${e}, ${t-1})`),!!this.farmTiles.get(`(${e+1}, ${t-1})`),!!this.farmTiles.get(`(${e-1}, ${t})`),!!this.farmTiles.get(`(${e+1}, ${t})`),!!this.farmTiles.get(`(${e-1}, ${t+1})`),!!this.farmTiles.get(`(${e}, ${t+1})`),!!this.farmTiles.get(`(${e+1}, ${t+1})`)]}}class fe extends M{constructor(){super(...arguments),this.autoSave=!0,this.exportToClipboard=!1}initialize(){this.initializeSaveSettings()}initializeSaveSettings(){{const e=E("#auto-save-toggle");S.attach(e).onClick=t=>{t===i.LEFT&&(e.querySelector(".checkbox-thumb").classList.toggle("enabled"),this.autoSave=!this.autoSave)}}{const e=E("#import-save");S.attach(e).onClick=e=>{i.LEFT};const t=E("#export-save");S.attach(t).onClick=e=>{i.LEFT};const r=E("#export-clipboard");S.attach(r).onClick=e=>{i.LEFT}}}}class we{constructor(e=0,t=0){this.attachedElements=[],this.setParts(e,t)}attachElement(e){this.attachedElements.push(e),e.innerText=this.toString()}updateElements(){for(const e of this.attachedElements)e.innerText=this.toString()}static fromNumber(e){if(isNaN(e)||!isFinite(e))throw new Error("Invalid number.");const[t,r]=e.toExponential().split("e").map(Number);return new we(t,r)}static fromString(e){const[t,r]=e.split("e").map(Number);return new we(t,r)}toString(){return this.exponent<6?`${Math.round(this.mantissa*Math.pow(10,this.exponent))}`:`${this.mantissa.toFixed(2)}e${this.exponent}`}setParts(e,t){if(isNaN(e)||isNaN(t)||!isFinite(e)||!isFinite(t))throw new Error("Invalid number parts.");this.mantissa=e,this.exponent=t,this.normalize(),this.updateElements()}normalize(){let e=this.mantissa,t=this.exponent;if(!Number.isInteger(t)){const r=Math.floor(t),s=t-r;e*=Math.pow(10,s),t=r}if(0===e)e=0;else{for(;Math.abs(e)>=10;)e/=10,t++;for(;Math.abs(e)<1&&0!==e;)e*=10,t--;e=parseFloat(e.toFixed(6))}this.mantissa=e,this.exponent=t}equals(e){return this.mantissa===e.mantissa&&this.exponent===e.exponent}greaterThan(e){return this.mantissa>e.mantissa||this.mantissa===e.mantissa&&this.exponent>e.exponent}greaterThanScalar(e){return this.greaterThan(we.fromNumber(e))}lessThan(e){return this.mantissa<e.mantissa||this.mantissa===e.mantissa&&this.exponent<e.exponent}lessThanScalar(e){return this.lessThan(we.fromNumber(e))}add(e){let t,r;this.exponent>e.exponent?(t=this,r=e):(t=e,r=this);const s=t.exponent-r.exponent,i=r.mantissa*Math.pow(10,-s),n=t.mantissa+i;this.setParts(n,t.exponent)}sub(e){this.add(new we(-e.mantissa,e.exponent))}mult(e){const t=this.mantissa*e.mantissa,r=this.exponent+e.exponent;this.setParts(t,r)}div(e){if(0===e.mantissa)throw new Error("Division by zero.");const t=this.mantissa/e.mantissa,r=this.exponent-e.exponent;this.setParts(t,r)}pow(e){const t=(Math.log10(this.mantissa)+this.exponent)*e.mantissa*Math.pow(10,e.exponent),r=Math.pow(10,t%1),s=Math.floor(t);this.setParts(r,s)}addScalar(e){this.add(new we(e,0))}subScalar(e){this.sub(new we(e,0))}multScalar(e){this.mult(new we(e,0))}divScalar(e){this.div(new we(e,0))}powScalar(e){const t=Math.pow(this.mantissa,e),r=this.exponent*e;this.setParts(t,r)}log10(){const e=Math.log10(this.mantissa)+this.exponent;return new we(e,0)}ln(){const e=Math.log(this.mantissa)+this.exponent*Math.LN10;return new we(e,0)}}class be extends M{constructor(e,t,r,s){super(e),this.name=t,this.color=r,this.amount=we.fromNumber(s)}attachElement(e){this.amount.attachElement(e),e.style.setProperty("--currency-color",this.color)}}class ye extends be{constructor(e){super(e,"Plant-Food","#af4",0)}}class xe extends oe{constructor(e,t,r,s,i,n,o){super(e),this.requires=[],this.prevX=this.x=t,this.prevY=this.y=r,this.staticPoint=s,this.name=i,this.desc=n,this.requires=o}initialize(){S.attach(this.body).onHover=()=>{console.log("hover")}}updateWorldTransform(e,t){this.body.style.left=`${e+this.x}px`,this.body.style.top=`${t+this.y}px`}attractTowards(e){let t=0,r=0;for(let s=0;s<e.length;s++){const i=e[s],n=i.x-this.x,o=i.y-this.y,a=1/(n*n+o*o);t+=n*a,r+=o*a}this.x+=t,this.y+=r}killAttractors(e){for(let t=0;t<e.length;t++){const r=e[t],s=r.x-this.x,i=r.y-this.y;s*s+i*i<2500&&(e.splice(t,1),t--)}}update(){this.staticPoint||(this.x,this.prevX,this.y,this.prevY,this.prevX=this.x,this.prevY=this.y)}maintainChains(){for(const e of this.requires){const t=ve.nodesByName.get(e);this.chainNodes(t)}}chainNodes(e){if(this.staticPoint)return;const t=this.x-e.x,r=this.y-e.y,s=t*t+r*r,i=Math.sqrt(s);let n=-this.y;n<0&&(n=0);const o=100-n/100;if(i<o)return;const a=o*t/i,h=o*r/i;this.x=e.x+a,this.y=e.y+h}pushNode(e){const t=e.x-this.x,r=e.y-this.y,s=t*t+r*r,i=Math.sqrt(s);if(i<.01)return;if(i>100)return;let n=1/(i/200);n>500&&(n=500);const o=n*t/i,a=n*r/i;this.staticPoint||(this.x-=o,this.y-=a),e.staticPoint||(e.x+=o,e.y+=a)}createElement(e){this.body=k({id:this.name,classes:["tech-node"],parent:e})}}r(318).R;class ve extends M{constructor(){super(...arguments),this.nodeLeaves=[],this.nodeAttractors=[],this.activeNodes=new Set}initialize(){const e=k({id:"technology-tree",parent:C("technology-screen")});this.root.windowMouse.onClick=t=>{var r,s;if(t!==i.LEFT)return;const n=ve.nodesByName.size,o="test"+n,a=this.nodeLeaves[Math.floor(Math.random()*this.nodeLeaves.length)],h="test"+a,l=ve.allNodes[a],c=null!==(r=null==l?void 0:l.x)&&void 0!==r?r:0,d=null!==(s=null==l?void 0:l.y)&&void 0!==s?s:0,m=new xe(this.root,c,d,0===n,o,o,[h]),u=Math.log2(-m.y/100);for(let e=0;e<1e3;e++){const e=100*(Math.random()-.5),t=-100*Math.random()-50;this.nodeAttractors.push(new ie(e,t))}let g=0;do{this.nodeLeaves.push(n)}while(g++<u);ve.nodesByName.set(o,m),ve.allNodes.push(m),m.createElement(e),m.initialize(),l&&(this.activeNodes.add(m),this.nodeLeaves.splice(this.nodeLeaves.findIndex((e=>e===a)),1),this.nodeLeaves.includes(a)||(this.activeNodes.delete(l),l.staticPoint=!0))}}update(){for(const e of this.activeNodes)e.attractTowards(this.nodeAttractors);for(const e of this.activeNodes)e.killAttractors(this.nodeAttractors);for(let e=0;e<ve.allNodes.length;e++){const t=ve.allNodes[e];for(let r=e+1;r<ve.allNodes.length;r++){const e=ve.allNodes[r];t.pushNode(e)}}for(let e=1;e<ve.allNodes.length;e++)ve.allNodes[e].maintainChains()}drawLines(e){for(const t of ve.allNodes)for(const r of t.requires){const s=ve.nodesByName.get(r);s&&(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(s.x,s.y),e.stroke())}for(const t of this.nodeAttractors)e.beginPath(),e.arc(t.x,t.y,5,0,2*Math.PI),e.fillStyle="#f00",e.fill()}updateWorldTransform(e,t){ve.nodesByName.forEach((r=>r.updateWorldTransform(e,t)))}}ve.allNodes=[],ve.nodesByName=new Map;class ke extends te{constructor(e){super(e,"technology"),this.tileSize=100,this.background=new ne(e,"technology-background"),this.techTree=new ve(e),this.currency=new ye(e),L.registerCurrency(this.currency)}initialize(){this.background.initialize(),this.background.onCenterChange.add(this.updateWorldTransform.bind(this)),this.techTree.initialize(),this.currency.initialize(),this.setupTileCanvas(),this.updateWorldTransform()}update(){this.techTree.update()}updateFrame(){this.drawBackground(),this.updateWorldTransform()}updateWorldTransform(){const e=this.background.getCenter();this.techTree.updateWorldTransform(e.x,e.y)}setupTileCanvas(){this.tileCanvas=T();const e=this.tileSize;this.tileCanvas.width=e,this.tileCanvas.height=e;const t=this.tileCanvas.getContext("2d");t.fillStyle="#569",t.fillRect(0,0,e,e),t.fillStyle="#303f66",t.beginPath(),t.arc(e/2,e/2,.65*e,0,2*Math.PI),t.fill(),t.lineWidth=2,t.strokeStyle="#569",t.strokeRect(0,0,e,e)}drawBackground(){this.background.startDrawing();const e=this.background.context,t=this.root.windowWidth,r=this.root.windowHeight,s=this.background.worldX,i=this.background.worldY,n=Math.floor((t/2-s)/this.tileSize),o=Math.floor((r/2-i)/this.tileSize),a=Math.floor((-t/2-s)/this.tileSize),h=Math.floor((-r/2-i)/this.tileSize);for(let t=a;t<=n;t++)for(let r=h;r<=o;r++)e.drawImage(this.tileCanvas,t*this.tileSize,r*this.tileSize);this.techTree.drawLines(e),this.background.finalizeDrawing()}}class Te{constructor(){this.windowWidth=0,this.windowHeight=0,this.seed="Shrimp",this.allScreens=[],this.allScreens.push(new pe(this)),this.allScreens.push(new ke(this)),this.allScreens.push(new te(this,"settings")),this.disableAllScreens(),this.allScreens[0].enable(this,null),this.settings=new fe(this),this.currencyManager=new L(this)}initialize(){this.windowMouse=S.attach(document.body),this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,document.body.dispatchEvent(new Event("resize")),window.addEventListener("resize",(()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,document.body.dispatchEvent(new Event("resize"))})),this.settings.initialize(),this.currencyManager.initialize(),this.allScreens.forEach((e=>e.initialize()))}disableAllScreens(){this.allScreens.forEach((e=>e.disable()))}update(e){this.allScreens.forEach((t=>t.update(e)))}updateFrame(){this.allScreens.forEach((e=>e.updateFrame()))}}var Ce;!function(e){e[e.Chrome=0]="Chrome",e[e.Firefox=1]="Firefox",e[e.Safari=2]="Safari",e[e.Edge=3]="Edge",e[e.IE=4]="IE",e[e.Opera=5]="Opera",e[e.Unknown=6]="Unknown"}(Ce||(Ce={}));const Ee=new s("Browser Support","✔️");class Se{static initialize(){this.browser=this.detectBrowser(),Ee.log("Browser: "+Ce[this.browser]),this.updateScrollbars()}static updateScrollbars(){if(this.browser!==Ce.Firefox)return;const e=[...document.getElementsByClassName("scrollable")];for(const t of e)t.classList.remove("scrollable"),t.classList.add("firefox-scrollbar")}static detectBrowser(){const e=navigator.userAgent;return/chrome|crios|crmo/i.test(e)?Ce.Chrome:/firefox|fxios/i.test(e)?Ce.Firefox:/safari/i.test(e)?Ce.Safari:/edg/i.test(e)?Ce.Edge:/trident/i.test(e)?Ce.IE:/opr\//i.test(e)?Ce.Opera:Ce.Unknown}}const Me=new s("Error Screen","❌");class Le{static setInactive(){C("error-screen").style.display="none"}static setActive(e=null){let t=e;e instanceof Error&&(t=e.message),e&&(C("error-screen").style.display="flex",E("#error-screen .error").innerHTML=`<span>Error: </span> ${t}`),C("structure").remove(),Me.toggleName(),Me.toggleSymbol(),Me.error(e)}}class ze{constructor(){this.root=new Te,this.fpsCounter=new y}initialize(){Se.initialize(),this.root.initialize(),this.preload(),this.startRunning()}preload(){setTimeout((()=>{const e=[...document.getElementsByClassName("preload")];for(const t of e)t.classList.remove("preload")}),500),Le.setInactive()}startRunning(){const e=this.fpsCounter.update();this.root.update(e),this.root.updateFrame(),requestAnimationFrame((()=>this.startRunning()))}}const Ne=new s("Index Initialization","✅");Ne.log("Renderer initialized successfully!"),Ne.log("Imported main successfully!"),Ne.log("Starting the main process...");try{(new ze).initialize()}catch(e){Le.setActive(e)}})();